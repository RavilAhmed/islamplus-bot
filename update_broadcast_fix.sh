#!/bin/bash
set -e

echo "üì§ –ö–æ–ø–∏—Ä—É—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Ä–∞—Å—Å—ã–ª–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä..."

# –ö–æ–ø–∏—Ä—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
scp "src/services/notification_service.py" root@194.67.127.172:/opt/islamplus-bot/src/services/notification_service.py
scp "src/handlers/broadcast.py" root@194.67.127.172:/opt/islamplus-bot/src/handlers/broadcast.py

echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—é –±–æ—Ç–∞..."
ssh root@194.67.127.172 "systemctl restart islamplus-bot"

echo "‚è≥ –ñ–¥—É 3 —Å–µ–∫—É–Ω–¥—ã..."
sleep 3

echo "üìä –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞:"
ssh root@194.67.127.172 "systemctl status islamplus-bot --no-pager -l | head -15"

echo ""
echo "‚úÖ –ì–æ—Ç–æ–≤–æ! –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã."
echo ""
echo "üìù –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:"
echo "  - –¢–µ–ø–µ—Ä—å {name} –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ä—É—á–Ω—ã—Ö —Ä–∞—Å—Å—ã–ª–∫–∞—Ö"
echo "  - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ç–æ (–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏)"
echo "  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏"
echo ""
echo "üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:"
echo "  - –í —Ç–µ–∫—Å—Ç–µ —Ä–∞—Å—Å—ã–ª–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ {name} –∏–ª–∏ #{name} –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
echo "  - –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ç–æ —Å —Ç–µ–∫—Å—Ç–æ–º - —Ñ–æ—Ç–æ –±—É–¥–µ—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–æ –∫ —Å–æ–æ–±—â–µ–Ω–∏—é"
echo ""
echo "üîç –ï—Å–ª–∏ —Ñ–æ—Ç–æ –≤—Å–µ –µ—â–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:"
echo "  ssh root@194.67.127.172 'journalctl -u islamplus-bot -n 100 --no-pager | grep -i photo'"
echo ""
echo "üìÅ –¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –ø–∞–ø–∫—É images:"
echo "  ssh root@194.67.127.172 'ls -ld /opt/islamplus-bot/images && chmod 755 /opt/islamplus-bot/images'"
